[2020-12-12 12:04:55,174] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:04:55,175] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:04:55,175] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 1 partitions (state.change.logger)
[2020-12-12 12:04:55,179] INFO [Broker id=0] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2020-12-12 12:04:55,190] INFO [Controller id=0 epoch=9] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:1,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:04:55,191] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:04:55,192] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:04:55,193] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:04:55,193] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:04:55,194] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:04:55,197] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:04:55,205] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 5 epoch 9 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
org.apache.kafka.common.errors.KafkaStorageException: Error while renaming dir for test-0 in log dir /tmp/kafka-logs
Caused by: java.nio.file.DirectoryNotEmptyException: /tmp/kafka-logs/test-0
	at java.base/sun.nio.fs.UnixCopyFile.ensureEmptyDir(UnixCopyFile.java:384)
	at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:484)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
	at java.base/java.nio.file.Files.move(Files.java:1421)
	at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:913)
	at kafka.log.Log.$anonfun$renameDir$2(Log.scala:981)
	at kafka.log.Log.renameDir(Log.scala:2340)
	at kafka.log.LogManager.asyncDelete(LogManager.scala:935)
	at kafka.cluster.Partition.$anonfun$delete$1(Partition.scala:470)
	at kafka.cluster.Partition.delete(Partition.scala:461)
	at kafka.server.ReplicaManager.stopReplica(ReplicaManager.scala:344)
	at kafka.server.ReplicaManager.$anonfun$stopReplicas$9(ReplicaManager.scala:448)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:149)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:237)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:44)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:149)
	at kafka.server.ReplicaManager.stopReplicas(ReplicaManager.scala:445)
	at kafka.server.KafkaApis.handleStopReplicaRequest(KafkaApis.scala:252)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:137)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70)
	at java.base/java.lang.Thread.run(Thread.java:834)
	Suppressed: java.nio.file.AtomicMoveNotSupportedException: /tmp/kafka-logs/test-0 -> /tmp/kafka-logs/test-0.1a1b45a6bf9743bd9851a914d7ed180d-delete: Invalid cross-device link
		at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:415)
		at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
		at java.base/java.nio.file.Files.move(Files.java:1421)
		at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:910)
		... 17 more
[2020-12-12 12:04:55,208] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:04:55,211] INFO [Controller id=0 epoch=9] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:2,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:04:55,212] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:04:55,212] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:04:55,222] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:06:37,590] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2020-12-12 12:06:37,625] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 50 become-leader and 1 become-follower partitions (state.change.logger)
[2020-12-12 12:06:37,627] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 51 partitions (state.change.logger)
[2020-12-12 12:06:37,647] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:06:37,648] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:06:37,649] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 1 partitions (state.change.logger)
[2020-12-12 12:06:37,664] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 51 partitions (state.change.logger)
[2020-12-12 12:06:37,667] INFO [Controller id=0 epoch=10] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:06:37,668] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:06:37,669] INFO [Controller id=0 epoch=10] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:06:37,670] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:06:37,670] INFO [Controller id=0 epoch=10] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:06:37,707] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 10 as part of the become-leader transition for 50 partitions (state.change.logger)
[2020-12-12 12:06:37,716] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,723] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,725] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,726] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,728] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,729] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,731] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,732] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,734] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,735] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,737] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,739] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,740] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,742] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,743] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,745] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,746] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,748] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 363 with high watermark 361 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,750] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,752] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,753] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,754] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,756] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,757] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,759] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,760] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,762] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,763] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,765] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 6 with high watermark 5 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,766] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,767] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,769] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,770] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,771] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,773] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,774] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,776] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,778] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,779] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,781] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,782] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,785] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,787] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,789] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,791] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,792] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,794] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,795] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,796] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,798] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:06:37,801] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition test-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2020-12-12 12:06:37,801] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 1 for 0 partitions (state.change.logger)
[2020-12-12 12:06:37,822] INFO [Broker id=0] Add 50 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 2 (state.change.logger)
[2020-12-12 12:06:37,824] INFO [Broker id=0] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 3 (state.change.logger)
[2020-12-12 12:06:37,825] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:06:37,831] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:06:37,841] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 5 epoch 10 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
org.apache.kafka.common.errors.KafkaStorageException: Error while renaming dir for test-0 in log dir /tmp/kafka-logs
Caused by: java.nio.file.DirectoryNotEmptyException: /tmp/kafka-logs/test-0
	at java.base/sun.nio.fs.UnixCopyFile.ensureEmptyDir(UnixCopyFile.java:384)
	at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:484)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
	at java.base/java.nio.file.Files.move(Files.java:1421)
	at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:913)
	at kafka.log.Log.$anonfun$renameDir$2(Log.scala:981)
	at kafka.log.Log.renameDir(Log.scala:2340)
	at kafka.log.LogManager.asyncDelete(LogManager.scala:935)
	at kafka.cluster.Partition.$anonfun$delete$1(Partition.scala:470)
	at kafka.cluster.Partition.delete(Partition.scala:461)
	at kafka.server.ReplicaManager.stopReplica(ReplicaManager.scala:344)
	at kafka.server.ReplicaManager.$anonfun$stopReplicas$9(ReplicaManager.scala:448)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:149)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:237)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:44)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:149)
	at kafka.server.ReplicaManager.stopReplicas(ReplicaManager.scala:445)
	at kafka.server.KafkaApis.handleStopReplicaRequest(KafkaApis.scala:252)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:137)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70)
	at java.base/java.lang.Thread.run(Thread.java:834)
	Suppressed: java.nio.file.AtomicMoveNotSupportedException: /tmp/kafka-logs/test-0 -> /tmp/kafka-logs/test-0.573800ac66154d08baf0c0968fa0857d-delete: Invalid cross-device link
		at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:415)
		at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
		at java.base/java.nio.file.Files.move(Files.java:1421)
		at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:910)
		... 17 more
[2020-12-12 12:06:37,846] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:06:37,851] INFO [Controller id=0 epoch=10] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:06:37,851] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:06:37,851] INFO [Controller id=0 epoch=10] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:06:37,865] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:08:28,539] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2020-12-12 12:08:28,572] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 50 become-leader and 1 become-follower partitions (state.change.logger)
[2020-12-12 12:08:28,573] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 51 partitions (state.change.logger)
[2020-12-12 12:08:28,594] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:08:28,595] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:08:28,596] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 1 partitions (state.change.logger)
[2020-12-12 12:08:28,616] INFO [Controller id=0 epoch=11] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:5,ControllerEpoch:11) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:08:28,617] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:08:28,619] INFO [Controller id=0 epoch=11] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:08:28,620] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:08:28,621] INFO [Controller id=0 epoch=11] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:08:28,624] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 51 partitions (state.change.logger)
[2020-12-12 12:08:28,659] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 11 as part of the become-leader transition for 50 partitions (state.change.logger)
[2020-12-12 12:08:28,666] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,672] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,674] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,675] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,677] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,678] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,679] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,681] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,683] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,685] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,687] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,689] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,690] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,692] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,693] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,694] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,696] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,697] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 363 with high watermark 363 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,697] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,699] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,700] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,701] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,703] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,704] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,706] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,707] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,708] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,710] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,711] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 6 with high watermark 6 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,711] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,713] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,714] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,715] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,717] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,718] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,720] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,721] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,722] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,724] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,725] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,727] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,728] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,730] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,731] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,732] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,734] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,735] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,736] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,738] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,739] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:08:28,742] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition test-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2020-12-12 12:08:28,743] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 1 for 0 partitions (state.change.logger)
[2020-12-12 12:08:28,764] INFO [Broker id=0] Add 50 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2020-12-12 12:08:28,767] INFO [Broker id=0] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 3 (state.change.logger)
[2020-12-12 12:08:28,769] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:08:28,775] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:08:28,786] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 5 epoch 11 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
org.apache.kafka.common.errors.KafkaStorageException: Error while renaming dir for test-0 in log dir /tmp/kafka-logs
Caused by: java.nio.file.DirectoryNotEmptyException: /tmp/kafka-logs/test-0
	at java.base/sun.nio.fs.UnixCopyFile.ensureEmptyDir(UnixCopyFile.java:384)
	at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:484)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
	at java.base/java.nio.file.Files.move(Files.java:1421)
	at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:913)
	at kafka.log.Log.$anonfun$renameDir$2(Log.scala:981)
	at kafka.log.Log.renameDir(Log.scala:2340)
	at kafka.log.LogManager.asyncDelete(LogManager.scala:935)
	at kafka.cluster.Partition.$anonfun$delete$1(Partition.scala:470)
	at kafka.cluster.Partition.delete(Partition.scala:461)
	at kafka.server.ReplicaManager.stopReplica(ReplicaManager.scala:344)
	at kafka.server.ReplicaManager.$anonfun$stopReplicas$9(ReplicaManager.scala:448)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:149)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:237)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:44)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:149)
	at kafka.server.ReplicaManager.stopReplicas(ReplicaManager.scala:445)
	at kafka.server.KafkaApis.handleStopReplicaRequest(KafkaApis.scala:252)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:137)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70)
	at java.base/java.lang.Thread.run(Thread.java:834)
	Suppressed: java.nio.file.AtomicMoveNotSupportedException: /tmp/kafka-logs/test-0 -> /tmp/kafka-logs/test-0.478b32aa23a74a07a2baf738d62645e2-delete: Invalid cross-device link
		at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:415)
		at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
		at java.base/java.nio.file.Files.move(Files.java:1421)
		at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:910)
		... 17 more
[2020-12-12 12:08:28,791] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:08:28,797] INFO [Controller id=0 epoch=11] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:6,ControllerEpoch:11) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:08:28,797] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:08:28,797] INFO [Controller id=0 epoch=11] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:08:28,809] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:16:47,632] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2020-12-12 12:16:47,660] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 51 become-leader and 0 become-follower partitions (state.change.logger)
[2020-12-12 12:16:47,662] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 51 partitions (state.change.logger)
[2020-12-12 12:16:47,706] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 51 partitions (state.change.logger)
[2020-12-12 12:16:47,739] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 9 as part of the become-leader transition for 51 partitions (state.change.logger)
[2020-12-12 12:16:47,748] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,754] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,756] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,757] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,759] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,761] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,762] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,764] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,766] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,768] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,769] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,771] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,773] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,774] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,776] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,778] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,780] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,781] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 219 with high watermark 219 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,782] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,783] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,785] INFO [Broker id=0] Leader test-0 starts at leader epoch 0 from offset 9 with high watermark 9 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,785] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,788] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,790] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,792] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,794] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,795] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,797] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,799] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,801] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,802] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,804] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,806] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,807] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,809] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,810] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,812] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,814] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,815] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,817] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,819] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,820] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,822] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,824] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,825] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,827] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,829] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,830] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,832] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,833] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,835] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:16:47,860] INFO [Broker id=0] Add 51 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2020-12-12 12:27:14,979] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:27:14,980] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:27:14,980] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 1 partitions (state.change.logger)
[2020-12-12 12:27:14,983] INFO [Broker id=0] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2020-12-12 12:27:14,995] INFO [Controller id=0 epoch=9] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:1,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:27:14,996] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:27:14,997] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:27:14,998] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:27:14,998] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:27:14,998] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:27:15,002] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:27:15,010] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 5 epoch 9 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
org.apache.kafka.common.errors.KafkaStorageException: Error while renaming dir for test-0 in log dir /tmp/kafka-logs
Caused by: java.nio.file.DirectoryNotEmptyException: /tmp/kafka-logs/test-0
	at java.base/sun.nio.fs.UnixCopyFile.ensureEmptyDir(UnixCopyFile.java:384)
	at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:484)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
	at java.base/java.nio.file.Files.move(Files.java:1421)
	at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:913)
	at kafka.log.Log.$anonfun$renameDir$2(Log.scala:981)
	at kafka.log.Log.renameDir(Log.scala:2340)
	at kafka.log.LogManager.asyncDelete(LogManager.scala:935)
	at kafka.cluster.Partition.$anonfun$delete$1(Partition.scala:470)
	at kafka.cluster.Partition.delete(Partition.scala:461)
	at kafka.server.ReplicaManager.stopReplica(ReplicaManager.scala:344)
	at kafka.server.ReplicaManager.$anonfun$stopReplicas$9(ReplicaManager.scala:448)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:149)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:237)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:44)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:149)
	at kafka.server.ReplicaManager.stopReplicas(ReplicaManager.scala:445)
	at kafka.server.KafkaApis.handleStopReplicaRequest(KafkaApis.scala:252)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:137)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70)
	at java.base/java.lang.Thread.run(Thread.java:834)
	Suppressed: java.nio.file.AtomicMoveNotSupportedException: /tmp/kafka-logs/test-0 -> /tmp/kafka-logs/test-0.a127cce671fe44cb87eefaeb2362e3be-delete: Invalid cross-device link
		at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:415)
		at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
		at java.base/java.nio.file.Files.move(Files.java:1421)
		at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:910)
		... 17 more
[2020-12-12 12:27:15,013] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:27:15,017] INFO [Controller id=0 epoch=9] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:2,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:27:15,017] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:27:15,017] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:27:15,027] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:28:06,223] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2020-12-12 12:28:06,257] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 50 become-leader and 1 become-follower partitions (state.change.logger)
[2020-12-12 12:28:06,259] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 51 partitions (state.change.logger)
[2020-12-12 12:28:06,283] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:06,284] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:06,288] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set(0) for 1 partitions (state.change.logger)
[2020-12-12 12:28:06,298] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 51 partitions (state.change.logger)
[2020-12-12 12:28:06,306] INFO [Controller id=0 epoch=10] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:28:06,307] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:06,308] INFO [Controller id=0 epoch=10] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:28:06,310] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:06,310] INFO [Controller id=0 epoch=10] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:28:06,338] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 10 as part of the become-leader transition for 50 partitions (state.change.logger)
[2020-12-12 12:28:06,345] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,351] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,353] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,354] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,356] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,357] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,359] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,360] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,362] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,363] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,365] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,366] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,367] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,369] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,370] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,372] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,373] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,375] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 344 with high watermark 342 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,377] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,378] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,380] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,381] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,383] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,384] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,386] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,387] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,389] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,391] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,393] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,393] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,395] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,398] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,399] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,401] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,402] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,404] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,405] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,407] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,408] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,410] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,411] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,413] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,414] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,416] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,418] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,419] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,421] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,422] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,423] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,425] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:06,428] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition test-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2020-12-12 12:28:06,428] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 1 for 0 partitions (state.change.logger)
[2020-12-12 12:28:06,452] INFO [Broker id=0] Add 50 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 2 (state.change.logger)
[2020-12-12 12:28:06,455] INFO [Broker id=0] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 3 (state.change.logger)
[2020-12-12 12:28:06,457] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:28:06,462] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:28:06,472] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 5 epoch 10 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
org.apache.kafka.common.errors.KafkaStorageException: Error while renaming dir for test-0 in log dir /tmp/kafka-logs
Caused by: java.nio.file.DirectoryNotEmptyException: /tmp/kafka-logs/test-0
	at java.base/sun.nio.fs.UnixCopyFile.ensureEmptyDir(UnixCopyFile.java:384)
	at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:484)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
	at java.base/java.nio.file.Files.move(Files.java:1421)
	at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:913)
	at kafka.log.Log.$anonfun$renameDir$2(Log.scala:981)
	at kafka.log.Log.renameDir(Log.scala:2340)
	at kafka.log.LogManager.asyncDelete(LogManager.scala:935)
	at kafka.cluster.Partition.$anonfun$delete$1(Partition.scala:470)
	at kafka.cluster.Partition.delete(Partition.scala:461)
	at kafka.server.ReplicaManager.stopReplica(ReplicaManager.scala:344)
	at kafka.server.ReplicaManager.$anonfun$stopReplicas$9(ReplicaManager.scala:448)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:149)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:237)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:44)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:149)
	at kafka.server.ReplicaManager.stopReplicas(ReplicaManager.scala:445)
	at kafka.server.KafkaApis.handleStopReplicaRequest(KafkaApis.scala:252)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:137)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70)
	at java.base/java.lang.Thread.run(Thread.java:834)
	Suppressed: java.nio.file.AtomicMoveNotSupportedException: /tmp/kafka-logs/test-0 -> /tmp/kafka-logs/test-0.9131ceb0b23e419e96a1b6f7dc9ba88c-delete: Invalid cross-device link
		at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:415)
		at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
		at java.base/java.nio.file.Files.move(Files.java:1421)
		at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:910)
		... 17 more
[2020-12-12 12:28:06,477] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:06,483] INFO [Controller id=0 epoch=10] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:28:06,483] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:06,483] INFO [Controller id=0 epoch=10] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:28:06,503] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:28:48,456] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2020-12-12 12:28:48,490] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 50 become-leader and 1 become-follower partitions (state.change.logger)
[2020-12-12 12:28:48,493] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 51 partitions (state.change.logger)
[2020-12-12 12:28:48,508] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:48,509] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:48,510] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set(0) for 1 partitions (state.change.logger)
[2020-12-12 12:28:48,554] INFO [Controller id=0 epoch=11] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:5,ControllerEpoch:11) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:28:48,556] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:48,557] INFO [Controller id=0 epoch=11] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:28:48,559] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:48,559] INFO [Controller id=0 epoch=11] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:28:48,564] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 51 partitions (state.change.logger)
[2020-12-12 12:28:48,613] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 11 as part of the become-leader transition for 50 partitions (state.change.logger)
[2020-12-12 12:28:48,623] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,630] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,632] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,634] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,635] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,637] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,638] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,639] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,641] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,642] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,644] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,645] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,646] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,648] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,649] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,651] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,652] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,653] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 344 with high watermark 344 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,654] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,655] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,656] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,658] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,659] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,661] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,662] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,664] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,665] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,666] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,668] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,668] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,670] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,671] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,672] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,674] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,675] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,676] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,678] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,680] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,681] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,683] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,684] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,686] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,687] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,689] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,691] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,693] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,695] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,697] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,699] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,700] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:28:48,703] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition test-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2020-12-12 12:28:48,704] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 1 for 0 partitions (state.change.logger)
[2020-12-12 12:28:48,727] INFO [Broker id=0] Add 50 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2020-12-12 12:28:48,730] INFO [Broker id=0] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 3 (state.change.logger)
[2020-12-12 12:28:48,732] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:28:48,738] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:28:48,747] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 5 epoch 11 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
org.apache.kafka.common.errors.KafkaStorageException: Error while renaming dir for test-0 in log dir /tmp/kafka-logs
Caused by: java.nio.file.DirectoryNotEmptyException: /tmp/kafka-logs/test-0
	at java.base/sun.nio.fs.UnixCopyFile.ensureEmptyDir(UnixCopyFile.java:384)
	at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:484)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
	at java.base/java.nio.file.Files.move(Files.java:1421)
	at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:913)
	at kafka.log.Log.$anonfun$renameDir$2(Log.scala:981)
	at kafka.log.Log.renameDir(Log.scala:2340)
	at kafka.log.LogManager.asyncDelete(LogManager.scala:935)
	at kafka.cluster.Partition.$anonfun$delete$1(Partition.scala:470)
	at kafka.cluster.Partition.delete(Partition.scala:461)
	at kafka.server.ReplicaManager.stopReplica(ReplicaManager.scala:344)
	at kafka.server.ReplicaManager.$anonfun$stopReplicas$9(ReplicaManager.scala:448)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:149)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:237)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:44)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:149)
	at kafka.server.ReplicaManager.stopReplicas(ReplicaManager.scala:445)
	at kafka.server.KafkaApis.handleStopReplicaRequest(KafkaApis.scala:252)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:137)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70)
	at java.base/java.lang.Thread.run(Thread.java:834)
	Suppressed: java.nio.file.AtomicMoveNotSupportedException: /tmp/kafka-logs/test-0 -> /tmp/kafka-logs/test-0.23472088cf3c44a89ee61aeeebfedce7-delete: Invalid cross-device link
		at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:415)
		at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
		at java.base/java.nio.file.Files.move(Files.java:1421)
		at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:910)
		... 17 more
[2020-12-12 12:28:48,752] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:48,759] INFO [Controller id=0 epoch=11] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:6,ControllerEpoch:11) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:28:48,759] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:28:48,759] INFO [Controller id=0 epoch=11] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:28:48,775] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:43:05,295] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 0 partitions (state.change.logger)
[2020-12-12 12:43:05,326] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 51 become-leader and 0 become-follower partitions (state.change.logger)
[2020-12-12 12:43:05,328] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 51 partitions (state.change.logger)
[2020-12-12 12:43:05,372] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 51 partitions (state.change.logger)
[2020-12-12 12:43:05,417] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 9 as part of the become-leader transition for 51 partitions (state.change.logger)
[2020-12-12 12:43:05,425] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,432] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,433] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,435] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,436] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,438] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,440] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,442] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,443] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,445] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,446] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,448] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,449] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,450] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,452] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,453] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,455] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,456] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 219 with high watermark 219 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,456] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,458] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,459] INFO [Broker id=0] Leader test-0 starts at leader epoch 0 from offset 9 with high watermark 9 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,459] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,461] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,463] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,465] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,467] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,469] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,471] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,472] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,474] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,475] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,477] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,479] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,481] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,483] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,484] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,486] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,487] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,488] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,490] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,492] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,494] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,496] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,498] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,500] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,501] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,503] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,504] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,506] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,508] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,510] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2020-12-12 12:43:05,534] INFO [Broker id=0] Add 51 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2020-12-12 12:57:47,321] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:57:47,321] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:57:47,322] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set(0) for 1 partitions (state.change.logger)
[2020-12-12 12:57:47,325] INFO [Broker id=0] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 3 (state.change.logger)
[2020-12-12 12:57:47,334] INFO [Controller id=0 epoch=9] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:1,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:57:47,335] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:57:47,336] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:57:47,337] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:57:47,337] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:57:47,337] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:57:47,341] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2020-12-12 12:57:47,349] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 5 epoch 9 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
org.apache.kafka.common.errors.KafkaStorageException: Error while renaming dir for test-0 in log dir /tmp/kafka-logs
Caused by: java.nio.file.DirectoryNotEmptyException: /tmp/kafka-logs/test-0
	at java.base/sun.nio.fs.UnixCopyFile.ensureEmptyDir(UnixCopyFile.java:384)
	at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:484)
	at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
	at java.base/java.nio.file.Files.move(Files.java:1421)
	at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:913)
	at kafka.log.Log.$anonfun$renameDir$2(Log.scala:981)
	at kafka.log.Log.renameDir(Log.scala:2340)
	at kafka.log.LogManager.asyncDelete(LogManager.scala:935)
	at kafka.cluster.Partition.$anonfun$delete$1(Partition.scala:470)
	at kafka.cluster.Partition.delete(Partition.scala:461)
	at kafka.server.ReplicaManager.stopReplica(ReplicaManager.scala:344)
	at kafka.server.ReplicaManager.$anonfun$stopReplicas$9(ReplicaManager.scala:448)
	at scala.collection.mutable.HashMap.$anonfun$foreach$1(HashMap.scala:149)
	at scala.collection.mutable.HashTable.foreachEntry(HashTable.scala:237)
	at scala.collection.mutable.HashTable.foreachEntry$(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:44)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:149)
	at kafka.server.ReplicaManager.stopReplicas(ReplicaManager.scala:445)
	at kafka.server.KafkaApis.handleStopReplicaRequest(KafkaApis.scala:252)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:137)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:70)
	at java.base/java.lang.Thread.run(Thread.java:834)
	Suppressed: java.nio.file.AtomicMoveNotSupportedException: /tmp/kafka-logs/test-0 -> /tmp/kafka-logs/test-0.827eaaf3b3414d4bbcf8efe0147c23ee-delete: Invalid cross-device link
		at java.base/sun.nio.fs.UnixCopyFile.move(UnixCopyFile.java:415)
		at java.base/sun.nio.fs.UnixFileSystemProvider.move(UnixFileSystemProvider.java:267)
		at java.base/java.nio.file.Files.move(Files.java:1421)
		at org.apache.kafka.common.utils.Utils.atomicMoveWithFallback(Utils.java:910)
		... 17 more
[2020-12-12 12:57:47,351] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:57:47,355] INFO [Controller id=0 epoch=9] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:2,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2020-12-12 12:57:47,355] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2020-12-12 12:57:47,356] INFO [Controller id=0 epoch=9] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2020-12-12 12:57:47,366] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 0 for 1 partitions (state.change.logger)
